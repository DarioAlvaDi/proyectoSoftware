<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preferencias</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="../styles/stylePreferencias.css">
</head>
<body>
    
    <script src="../js/validaciones.js"></script>
    
    <header>
        <nav class="navbar navbar-expand-lg navColor">
            <div class="container-fluid">
                <div class="col-3 regresar">
                    <img src="../imgs/imgPerfil/image 29.png" alt="">
                </div>
                <div class="col-6 titulo">
                    Preferencias
                </div>
                <div class="col-3 inicio">
                    <img src="../imgs/imgPerfil/image 30.png" alt="">
                </div>
            </div> 
        </nav>
    </header>
        <form onsubmit="return validarPreferencia()" action="/turistas/pref" method="POST">
            <div class="container">
                <!-- <header>
                    <h1>Preferencias</h1>
                </header> -->
                <div class="row">
                    <div>
                        <h4>MARCA TUS PREFERENCIAS</h4>
                        <h6>(Al menos 3 de estas)</h6>
                    </div>
            <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 col-xxl-6">
                <div class="contenedor">
                    <div class="checkbox">
                        <ul>
                            <li><input type="checkbox" name="preferencias" id="PrefMuseos" value="museum"/>
                                <label for="PrefMuseos">Museos</label></li>
                            <li><input type="checkbox"name="preferencias" id="PrefParqueAtr" value="amusement_park"/>
                                <label for="PrefParqueAtr">Parque de diversiones</label></li>
                            <li><input type="checkbox"name="preferencias" id="PrefParques" value="park"/>
                                <label for="PrefParques">Parques</label></li>
                        </ul> 
                    </div>
                </div> 
            </div>
            <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 col-xxl-6">
                <div class="contenedor">
                    <div class="checkbox">
                        <ul>
                            <li><input type="checkbox"name="preferencias" id="PrefAcuario" value="aquarium"/>
                                <label for="PrefAcuario">Acuario</label></li>
                            <li><input type="checkbox"name="preferencias" id="PrefGalerias" value="art_gallery"/>
                                <label for="PrefGalerias">Galerias de Arte</label></li>
                            <li><input type="checkbox" name="preferencias" id="PrefIglesias" value="church"/>
                                <label for="PrefIglesias">Iglesias</label></li>
                        </ul> 
                    </div>
                </div> 
            </div>
            <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 col-xxl-6">
                <div class="contenedor">
                    <div class="checkbox">
                        <ul>
                            <li><input type="checkbox" name="preferencias" id="PrefRestaurantes" value="restaurant"/>
                                <label for="PrefRestaurantes">Restaurantes</label></li>
                            <li><input type="checkbox" name="preferencias" id="PrefBoliches" value="bowling_alley"/>
                                <label for="PrefBoliches">Boliches</label></li>
                            <li><input type="checkbox" name="preferencias" id="PrefZoologicos" value="zoo"/>
                                <label for="PrefZoologicos">Zoologicos</label></li>
                        </ul> 
                    </div>
                </div> 
            </div>
            <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 col-xxl-6">
                <div class="contenedor">
                    <div class="checkbox">
                        <ul>
                            <li><input type="checkbox"name="preferencias" id="PrefCafe" value="cafe"/>
                                <label for="PrefCafe">Cafeterias</label></li>
                            <li><input type="checkbox" name="preferencias" id="PrefBiblioteca" value="library"/>
                                <label for="PrefBiblioteca">Bibliotecas</label></li>
                            <li><input type="checkbox" name="preferencias" id="PrefCentrosNocturnos" value="night_club"/>
                                <label for="PrefCentrosNocturnos">Centros Nocturnos</label></li>
                        </ul> 
                    </div>
                </div> 
            </div>
            <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 col-xxl-6">
                <div class="contenedor">
                    <div class="checkbox">
                        <ul>
                            <li><input type="checkbox" name="preferencias" id="PrefBares" value="bar"/>
                                <label for="PrefBares" >Bares</label></li>
                            <li><input type="checkbox" name="preferencias" id="PrefCines" value="movie_theater"/>
                                <label for="PrefCines">Cines</label></li>
                            <li><input type="checkbox" name="preferencias" id="PrefCentrosComerciales" value="shopping_mall"/>
                                <label for="PrefCentrosComerciales">Centros comerciales</label></li>
                        </ul> 
                    </div>
                </div> 
            </div>
            <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 col-xxl-6">
                <div class="contenedor">
                    <div class="checkbox">
                        <ul>
                            <li><input type="checkbox" name="preferencias" id="PrefSpa" value="spa"/>
                                <label for="PrefSpa">Spas</label></li>
                            <li><input type="checkbox" name="preferencias" id="PrefCasino" value="casino"/>
                                <label for="PrefCasino">Casinos</label></li>
                            <li><input type="checkbox" name="preferencias" id="PrefEstadios" value="stadium"/>
                                <label for="PrefEstadios">Estadios</label></li>
                        </ul> 
                    </div>
                </div> 
            </div>
            <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12 col-xxl-12">
                <div class="contenedor">
                    <div class="number">
                        <label>Coloca tu radio de visualización (Km):</label>
                        <input type="number" id="radio" name="radio" placeholder="1 ó 1.5" step="0.5" onchange="validarRadio()"/>
                        <input type="hidden" name="idTurista" id="idTurista" value="<%= turistaId %>">
                    </div>
                </div>
                <nav id="radio-error" class="error-message text-center"></nav>
            </div>
            <br><br><br><br>
            <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12 col-xxl-12">
                <div class="contenedor">
                    <div class="submit">
                        <input type="submit" name="enviar" value="Guardar preferencias" onclick="validarCheckbox()"/>
                    </div>
                </div>
            </div>

        </form>    
            
        </div>
    </div>

    <div id="miAlert" class="mi-alert">
        <span id="mensaje"></span>
        <button id="btnContinuar" onclick="ocultarMensaje()">Continuar</button>
    </div>
    

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    
    <script>

        
function ocultarMensajeConRedireccion() {
            ocultarMensaje();
            window.location.href = "/turistas/datos"; 
        }
        function mostrarMensaje(mensaje) {
            var contenedor = document.getElementById("miAlert");
            var mensajeElemento = document.getElementById("mensaje");
        
            mensajeElemento.innerHTML = mensaje;
            contenedor.style.display = "flex"; // Cambiado a flex para centrar el botón
        
            // Desactiva el botón cuando se muestra el mensaje
            document.getElementById("btnContinuar").disabled = true;
        }
        
        function ocultarMensaje() {
            var contenedor = document.getElementById("miAlert");
            contenedor.style.display = "none";
        }
        
        function validarCheckbox() {
            var checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
            var cantidadCheckbox = checkboxes.length;
            var esRadioValido = validarRadio();
            var mensaje = "";
        
            if (cantidadCheckbox >= 3 && esRadioValido) {
                mensaje = "Beyamaps ha guardado tus preferencias ¡Listo para buscar tu lugar deseado!";
                mostrarMensajeConRedireccion(mensaje);
            }else if(cantidadCheckbox >=3 && !esRadioValido){
                mensaje = "<br>Ingrese un radio válido";
            }
             else {
                mensaje = "<br>Selecciona al menos 3 lugares de tu preferencia";
            }
        
            mostrarMensaje(mensaje);
            
            // Activa el botón solo cuando se muestra un mensaje
            document.getElementById("btnContinuar").disabled = false;
        }   
        
        function validarPreferencia(){
            var checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
            var cantidadCheckbox = checkboxes.length;
            var esRadioValido = validarRadio(); 

            if (cantidadCheckbox >= 3 && esRadioValido) {
                return true;
            } else {
                return false;
            }
        }

        function mostrarMensajeConRedireccion(mensaje) {
            var contenedor = document.getElementById("miAlert");
            var mensajeElemento = document.getElementById("mensaje");

            mensajeElemento.innerHTML = mensaje;
            contenedor.style.display = "flex"; 

            // Habilita el botón solo cuando se muestra el mensaje
            document.getElementById("btnContinuar").disabled = false;

            // Agrega un evento de clic al botón "Continuar"
            document.getElementById("btnContinuar").addEventListener("click", ocultarMensajeConRedireccion);
        }


        function validarRadio(){
            let RadioInput = document.getElementById("radio");
            let RadioValor = RadioInput.value.trim();



            if (RadioValor >50 || RadioValor <1) {
                mostrarError("radio", "El radio debe ser entre 1 y 50km<br>");
                return false;
            } else {
                ocultarError("radio");
                return true;
            }

        }
    </script>

    
</body>
</html>